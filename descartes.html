<!doctype html>
<script src="./descartes.js"></script>
<link rel=stylesheet href="./descartes.css">
<body>
  <div id="main"></div>
  <script>
    (function() {

      var node = (tag, attrs, children) => {
        var node = document.createElement(tag)
        for (var attr in attrs) {
          if (attr === 'style') {
            Object.assign(node.style, attrs[attr])
          } else {
            node.setAttribute(attr, attrs[attr])
          }
        }
        children && children.forEach(child => node.appendChild(typeof child === 'string' ? document.createTextNode(child) : child))
        return node
      }
      var named = tag => (attrs, children) => node(tag, attrs, children)
      var div = named('div')
      var span = named('span')
      var a = named('a')
      var raw = (text, tag='div') => {
        var node = document.createElement(tag)
        node.innerHTML = text
        return node
      };

      var render = (target, node) => {
        target.innerHTML = ''
        target.appendChild(node)
      };

      var root = document.getElementById('main')

      render(root, div({}, Object.keys(DATA).map(k => {
        return node('pre', {class: 'code', id: 'block-' + k}, [raw(DATA[k], 'code')])
      })))

      root.addEventListener('click', evt => {
        var id = evt.target.getAttribute('data-global-use')
        if (id) {
          window.location.hash = '#block-' + id
        }
      })

    })();
  </script>
</body>